sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/Device","sap/ui/core/Fragment","sap/m/MessageBox","sap/m/MessageToast"],function(e,t,o,n,i,s){"use strict";return e.extend("game.controller.Admin",{onInit:function(){},getModel:function(){return this.getOwnerComponent().getModel()},getRouter:function(){return this.getOwnerComponent().getRouter()},navigateTo:function(e,t){this.getRouter().navTo(e,t)},onTilePress:function(e){var t=e.getSource();var o=t.getBindingContext();this.getSplitAppObj().toDetail(this.createId("pageWord"),"slide",o,{});this.getSplitAppObj().getCurrentDetailPage().setBindingContext(o);this.getView().getModel("helpModel").setProperty("/isVisible",true)},getSplitAppObj:function(){return this.byId("admin")},getId(){return Number((new Date).getTime().toString().slice(9))},onAddNewCategoryPress:function(){var e=this.getView();let t=this.getId();n.load({name:"game.view.Fragments.CreateCategory",controller:this,id:e.getId()}).then(function(o){e.addDependent(o);var n=e.getModel().createEntry("/Categories",{properties:{ID:t}});o.setBindingContext(n);o.open()})},onCreateCategory:function(){this.getModel().submitChanges();this.byId("createCategoryPopup").close();this.byId("createCategoryPopup").destroy()},onCreateWord:function(){this.getModel().submitChanges();this.byId("createWordPopup").close();this.byId("createWordPopup").destroy()},onCancelCategory:function(){this.getModel().resetChanges();this.byId("createCategoryPopup").close();this.byId("createCategoryPopup").destroy()},onCancelWord:function(){this.getModel().resetChanges();this.byId("createWordPopup").close();this.byId("createWordPopup").destroy()},onCancelEditWord:function(){this.getModel().resetChanges();this.byId("editWordPopup").close();this.byId("editWordPopup").destroy()},onSaveWord:function(){this.getModel().submitChanges();this.byId("editWordPopup").close();this.byId("editWordPopup").destroy()},onAddNewWordPress(){var e=this.getView();let t=this.getId();let o=this.getSplitAppObj().getCurrentDetailPage().getBindingContext().getObject().ID;n.load({name:"game.view.Fragments.CreateWord",controller:this,id:e.getId()}).then(function(n){e.addDependent(n);var i=e.getModel().createEntry("/Words",{properties:{ID:t,Category_ID:o,createdAt:new Date,createdBy:"hanna.kaliada@leverx.com",modifiedAt:new Date,modifiedBy:"hanna.kaliada@leverx.com"}});n.setBindingContext(i);n.open()})},onMainPagePress:function(){this.navigateTo("Categories",{})},onEditCardPress:function(e){let t=e.getSource().getBindingContext();let o=this.getView();n.load({name:"game.view.Fragments.EditWord",controller:this,id:o.getId()}).then(function(e){o.addDependent(e);e.setBindingContext(t);e.open()})},onDeleteCardPress:function(e){let t=e.getSource().getBindingContext().getPath();let o=this.getView();i.confirm("Do you want to delete this item?",{onClose:function(e){if(e===i.Action.OK){o.getModel().remove(t);o.getModel().submitChanges();s.show("Success")}if(e===i.Action.CANCEL){o.getModel().resetChanges()}}})},onEditCategoryPress:function(){let e=this.getSplitAppObj().getCurrentDetailPage().getBindingContext();let t=this.getView();n.load({name:"game.view.Fragments.EditCategory",controller:this,id:t.getId()}).then(function(o){t.addDependent(o);o.setBindingContext(e);o.open()})},onSaveCategory:function(){this.getModel().submitChanges();this.byId("editCategoryPopup").close();this.byId("editCategoryPopup").destroy()},onCancelEditCategory:function(){this.getModel().resetChanges();this.byId("editCategoryPopup").close();this.byId("editCategoryPopup").destroy()},onDeleteCategoryPress:function(){let e=this.getSplitAppObj().getCurrentDetailPage().getBindingContext().getPath();let t=this.getView();let o=this.byId(n.createId("pageWord","words")).getItems();let r=o.map(e=>e.getBindingContext().getPath());i.confirm("Do you want to delete this category?",{onClose:function(o){if(o===i.Action.OK){t.getModel().remove(e);r.forEach(e=>t.getModel().remove(e));t.getModel().submitChanges();t.getModel("helpModel").setProperty("/isVisible",false);t.getModel().updateBindings();s.show("Success")}if(o===i.Action.CANCEL){t.getModel().resetChanges()}}})},onChangeWord:function(e){let t=e.getParameter("value");let o=t.slice(t.indexOf(" ")+1);let n=this.byId("createWordPopup").getBindingContext().getPath();let i=this.getModel();debugger;fetch("https://api.dictionaryapi.dev/api/v2/entries/en/"+o).then(e=>e.json()).then(e=>{if(e.length){for(let t=0;t<e[0].phonetics.length;t++){if(e[0].phonetics[t].audio!==""){i.setProperty(n+"/audioSrc",e[0].phonetics[t].audio);break}}}});let s={method:"GET",accessKey:"tb7EB4oWFcPivR0xWHqogkP5D7HhA0VZWHv8pyPyUMU",headers:{"Cache-control":"no-cache","Secret Key":"rewP1MivCvkPExbeuf6G-qQmMeRuTOSl_J1T2XjrGb0","Content-type":"application/json"}};fetch("https://api.unsplash.com/search/photos?page=1&query="+o,s).then(e=>e.json).then(e=>console.log(e))}})});